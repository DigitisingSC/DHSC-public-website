<?php

use \Drupal\Core\Entity\EntityInterface;
use \Drupal\paragraphs\ParagraphInterface;

/**
 * Implements hook_theme().
 */
function dhsc_site_theme() {
  return [
    'social_media_links' => [
      'variables' => [
        'social_links' => [],
      ],
    ],
    'search_form' => [
      'variables' => [
        'items' => [],
      ],
    ],
    'featured_links' => [
      'variables' => [
        'items' => [],
      ],
    ],
    'footer_branding' => [
      'variables' => [
        'logo' => null,
        'variant' => null,
        'site_slogan' => null,
        'site_name' => null
      ],
    ],
    'site_copyright' => [
      'variables' => [
        'text' => null,
      ],
    ],
    'footer_contact' => [
      'variables' => [
        'link' => null,
        'phone' => null,
      ],
    ],
  ];
}

/**
 * Implements hook_entity_form_mode_alter().
 */
function dhsc_site_entity_form_mode_alter(&$form_mode, EntityInterface $entity) {

  if (!$entity instanceof ParagraphInterface) {
    return;
  }

  $request_uri = \Drupal::request()->getRequestUri();
  $node = \Drupal::routeMatch()->getParameter('node');

  // Check if this a new entity.
  if (strpos($request_uri, 'node/add/landing_page')
    || isset($node)
    // @todo switch content type to Skill.
    && $node->getType() === 'landing_page'
    && $entity->getType() === 'accordion'
    || $entity->getType() === 'framework_section'){
    $form_mode = 'skills_framework';
  }
}

/**
 * Implements hook_entity_view_mode_alter().
 */
function dhsc_site_entity_view_mode_alter(&$view_mode, EntityInterface $entity)
{
  if (!$entity instanceof ParagraphInterface) {
    return;
  }

  $node = \Drupal::routeMatch()->getParameter('node');

  if ($node->getType() === 'landing_page'
    && $entity->getType() === 'accordion'
    || $entity->getType() === 'framework_section') {
    $view_mode = 'skills_framework';
  }
}
