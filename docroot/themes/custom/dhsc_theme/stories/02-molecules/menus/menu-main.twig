{# Classes #}
{% set classes = [
  'm-menu m-menu--main',
  'text-black',
] | sort | join(' ') | trim %}

{# Template #}
<nav{{ attributes.addClass(classes) }}>
  <div class="m-menu__container w-full">
    <ul class="m-menu--level-0 relative tablet:flex" x-data="{ isSelected: false }" @activedropdownmain.window="isSelected = $event.detail.active">
      {% for item in items %}
        <li class="tablet:mr-8 flex items-center" x-data="">
          {% if item.below %}
            <a href="#"
               class="flex items-center text-forest underline hover:no-underline mr-2"
               x-show="isSelected == false || isSelected != {{ loop.index }}"
               @click.prevent="$dispatch('activedropdownmain', { active: {{ loop.index }} }); $dispatch('closesearchtrigger')"
               @keydown.enter="$dispatch('activedropdownmain', { active: {{ loop.index }} }); $dispatch('closesearchtrigger')"
            ><span class="mr-2">{{ item.title }}</span>{{ svgIconDown }}</a>
            <a href="#"
               class="flex items-center text-forest underline hover:no-underline mr-2"
               x-show="isSelected == {{ loop.index }}"
               @click.prevent="$dispatch('activedropdownmain', { active: false })"
               @keydown.enter="$dispatch('activedropdownmain', { active: false })"
            ><span class="mr-2">{{ item.title }}</span>{{ svgIconUp }}</a>
          {% else %}
            <a href="{{ item.url }}"
               class="block mr-2 text-forest underline hover:no-underline"
               @click="$dispatch('activedropdownmain', { active: {{ loop.index }} })"
               @keydown.enter="$dispatch('activedropdownmain', { active: {{ loop.index }} })"
            >
              {{ item.title }}
            </a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
    <div x-data="{ isActive: false }">
      {% for item in items %}
        <div x-show="isActive == {{ loop.index }}"
             class="relative mt-4 -mb-4 w-[100vw] left-[50%] -translate-x-[50%] bg-white">
          <div class="container mx-auto">
            {% if loop.index == 1 %}
            <div class="tablet:flex tablet:items-start">
              <div class="tablet:w-6/12">
                <h3 class="text-md text-bold mt-4">{{ item.title }}</h3>
            {% endif %}
              <ul class="m-menu--level-1 py-4"
                    @activedropdownmain.window="isActive = $event.detail.active"
                >
                {% for subItem in item.below %}
                  <li class="tablet:mr-8 flex items-center">
                    <a href="{{ subItem.url }}" class="block text-forest underline hover:no-underline mb-2">{{ subItem.title }}</a>
                  </li>
                {% endfor %}
                </ul>
            {% if loop.index == 1 %}
              </div>
              {% if featuredLinks %}
              <div class="tablet:w-6/12">
                {{ featuredLinks }}
              </div>
              {% endif %}
            </div>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</nav>
